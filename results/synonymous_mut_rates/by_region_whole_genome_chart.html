<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.17.0"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "axis": {"grid": false}, "legend": {"columns": 1}}, "data": {"name": "data-07bde932f21733c230911468b5b64f0c"}, "mark": {"type": "point", "filled": true, "stroke": "black"}, "encoding": {"color": {"field": "clade", "scale": {"domain": ["20A (B.1)", "20B (B.1.1)", "20C (B.1.367)", "20E (B.1.177)", "20G (B.1.2)", "20I (Alpha)", "21C (Epsilon)", "21I (Delta)", "21J (Delta)", "21K (Omicron BA.1)", "21L (Omicron BA.2)", "22A (Omicron BA.4)", "22B (Omicron BA.5)", "22C (Omicron BA.2.12.1)"], "scheme": "viridis"}, "type": "nominal"}, "opacity": {"condition": {"value": 0.9, "selection": "selector009"}, "value": 0.45}, "shape": {"field": "subset", "scale": {"domain": ["USA", "England"]}, "sort": ["USA", "England"], "type": "nominal"}, "size": {"condition": {"value": 65, "selection": "selector009"}, "value": 45}, "strokeWidth": {"condition": {"value": 1.5, "selection": "selector009"}, "value": 0}, "tooltip": [{"field": "clade", "type": "nominal"}, {"field": "total_count", "type": "quantitative"}, {"field": "subset", "type": "nominal"}], "x": {"axis": {"labels": false, "ticks": false}, "field": "principal_component_2", "scale": {"nice": false, "padding": 10}, "title": "PC2 (22% variance)", "type": "quantitative"}, "y": {"axis": {"labels": false, "ticks": false}, "field": "principal_component_1", "scale": {"nice": false, "padding": 10}, "title": "PC1 (39% variance)", "type": "quantitative"}}, "height": 300, "selection": {"selector009": {"type": "multi", "fields": ["clade"], "bind": "legend"}, "selector010": {"type": "multi", "fields": ["subset"], "bind": "legend"}}, "title": "by region, whole genome", "transform": [{"filter": {"selection": "selector010"}}], "width": 169.555456092349, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-07bde932f21733c230911468b5b64f0c": [{"clade": "20A (B.1)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 8439, "AtoC": 0.01220523758739187, "AtoG": 0.0940869771299917, "AtoT": 0.030098352885412964, "CtoA": 0.018604100011849745, "CtoG": 0.0022514515937907334, "CtoT": 0.43464865505391637, "GtoA": 0.04668799620808153, "GtoC": 0.006872852233676976, "GtoT": 0.1558241497807797, "TtoA": 0.032823794288422796, "TtoC": 0.14302642493186396, "TtoG": 0.02287000829482166, "principal_component_1": 2.8340604342703695, "principal_component_2": 0.6737745349920711, "log10_total_count": 3.926290986884863}, {"clade": "20B (B.1.1)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 6129, "AtoC": 0.010279001468428781, "AtoG": 0.08663729809104258, "AtoT": 0.025615924294338392, "CtoA": 0.02186327296459455, "CtoG": 0.0019579050416054823, "CtoT": 0.43286017294827867, "GtoA": 0.04682656224506445, "GtoC": 0.005873715124816446, "GtoT": 0.15010605318975362, "TtoA": 0.034263338228095935, "TtoC": 0.15646924457497144, "TtoG": 0.027247511829009627, "principal_component_1": 3.411887942813383, "principal_component_2": -0.7066645871580405, "log10_total_count": 3.7873896213521094}, {"clade": "20C (B.1.367)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 8516, "AtoC": 0.013034288398309066, "AtoG": 0.10321747299201503, "AtoT": 0.028182245185533115, "CtoA": 0.022428370126820103, "CtoG": 0.0029356505401596992, "CtoT": 0.4160403945514326, "GtoA": 0.05014091122592767, "GtoC": 0.006810709253170503, "GtoT": 0.14537341474870832, "TtoA": 0.03616721465476749, "TtoC": 0.15159699389384687, "TtoG": 0.024072334429309537, "principal_component_1": 1.1598275306482355, "principal_component_2": 1.0651245746193583, "log10_total_count": 3.930235652766285}, {"clade": "20E (B.1.177)", "subset": "England", "partition": "all", "excluded": "no", "total_count": 6287, "AtoC": 0.013997136949260379, "AtoG": 0.09893430889136313, "AtoT": 0.02672180690313345, "CtoA": 0.018132654684269126, "CtoG": 0.002385875616351201, "CtoT": 0.4475902656274853, "GtoA": 0.044695403212979164, "GtoC": 0.004930809607125815, "GtoT": 0.13567679338317162, "TtoA": 0.03260696675679974, "TtoC": 0.15158263082551296, "TtoG": 0.022745347542548117, "principal_component_1": 2.884195431298145, "principal_component_2": -0.26298284448350817, "log10_total_count": 3.798443460350187}, {"clade": "20G (B.1.2)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 13950, "AtoC": 0.012186379928315413, "AtoG": 0.0913978494623656, "AtoT": 0.032688172043010756, "CtoA": 0.02121863799283154, "CtoG": 0.0025089605734767025, "CtoT": 0.4440143369175627, "GtoA": 0.05046594982078853, "GtoC": 0.0050896057347670255, "GtoT": 0.13591397849462367, "TtoA": 0.0349820788530466, "TtoC": 0.14537634408602151, "TtoG": 0.024157706093189964, "principal_component_1": 2.2477227680925544, "principal_component_2": -0.3709908319428924, "log10_total_count": 4.144574207609616}, {"clade": "20I (Alpha)", "subset": "England", "partition": "all", "excluded": "no", "total_count": 19559, "AtoC": 0.011759292397361829, "AtoG": 0.09969834858632855, "AtoT": 0.029807249859399764, "CtoA": 0.02321182064522726, "CtoG": 0.003221023569712153, "CtoT": 0.4624980827240657, "GtoA": 0.047139424305946115, "GtoC": 0.005317245257937522, "GtoT": 0.11406513625440974, "TtoA": 0.031341070606881745, "TtoC": 0.14878061250575184, "TtoG": 0.02316069328697786, "principal_component_1": 1.483768820921247, "principal_component_2": -0.9274289183853401, "log10_total_count": 4.291346646689625}, {"clade": "20I (Alpha)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 21919, "AtoC": 0.010766914549021397, "AtoG": 0.08996760801131438, "AtoT": 0.026050458506318718, "CtoA": 0.021579451617318307, "CtoG": 0.0027373511565308636, "CtoT": 0.43017473424882524, "GtoA": 0.04594187691044299, "GtoC": 0.004835987043204526, "GtoT": 0.15132989643688124, "TtoA": 0.04124275742506501, "TtoC": 0.14594643916237054, "TtoG": 0.029426524932706782, "principal_component_1": 3.449604528917334, "principal_component_2": -0.9921010404897633, "log10_total_count": 4.340820736655919}, {"clade": "21C (Epsilon)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 6276, "AtoC": 0.012906309751434034, "AtoG": 0.09002549394518802, "AtoT": 0.032664117272147866, "CtoA": 0.022944550669216062, "CtoG": 0.003983428935627789, "CtoT": 0.43722115997450606, "GtoA": 0.04796048438495857, "GtoC": 0.004620777565328234, "GtoT": 0.1325685149776928, "TtoA": 0.036010197578075206, "TtoC": 0.15152963671128106, "TtoG": 0.027565328234544297, "principal_component_1": 1.6371536116254402, "principal_component_2": -0.2814243714176799, "log10_total_count": 3.7976829349148993}, {"clade": "21I (Delta)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 17419, "AtoC": 0.014409552787186405, "AtoG": 0.12095987140478788, "AtoT": 0.03266548022274528, "CtoA": 0.02830242838280039, "CtoG": 0.0031574717262759055, "CtoT": 0.3831448418393708, "GtoA": 0.05488259946035938, "GtoC": 0.006716803490441472, "GtoT": 0.14352144210345025, "TtoA": 0.028876514151214193, "TtoC": 0.15764395200642975, "TtoG": 0.025719042424938287, "principal_component_1": -1.0813428059000163, "principal_component_2": 3.2774688068209876, "log10_total_count": 4.241023219159143}, {"clade": "21J (Delta)", "subset": "England", "partition": "all", "excluded": "no", "total_count": 80893, "AtoC": 0.014834410888457591, "AtoG": 0.10847662962184615, "AtoT": 0.032376101764058696, "CtoA": 0.02557699677351563, "CtoG": 0.0029668821776915183, "CtoT": 0.38759843249724946, "GtoA": 0.05077077126574611, "GtoC": 0.007417205444228796, "GtoT": 0.15960589915072998, "TtoA": 0.026479423435896803, "TtoC": 0.16237498918324206, "TtoG": 0.021522257797337224, "principal_component_1": -0.37196682464361297, "principal_component_2": 3.4099693979588435, "log10_total_count": 4.9079109419719265}, {"clade": "21J (Delta)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 138653, "AtoC": 0.01580203818164771, "AtoG": 0.11535271505124303, "AtoT": 0.03280130974447001, "CtoA": 0.0309261249305821, "CtoG": 0.0031445406879043367, "CtoT": 0.3822852733081866, "GtoA": 0.05307494248231196, "GtoC": 0.006390052865787253, "GtoT": 0.13475366562569868, "TtoA": 0.027788796491961948, "TtoC": 0.174103697720208, "TtoG": 0.02357684290999834, "principal_component_1": -1.8228462434856358, "principal_component_2": 3.3576857060986836, "log10_total_count": 5.141929270735738}, {"clade": "21K (Omicron BA.1)", "subset": "England", "partition": "all", "excluded": "no", "total_count": 36511, "AtoC": 0.011832050614883186, "AtoG": 0.10418777902549917, "AtoT": 0.034482758620689655, "CtoA": 0.027032948974281722, "CtoG": 0.002985401659773767, "CtoT": 0.42255758538522636, "GtoA": 0.05351811782750404, "GtoC": 0.005724302265070801, "GtoT": 0.06740434389636, "TtoA": 0.0694311303442798, "TtoC": 0.17868587548957848, "TtoG": 0.022157705896853005, "principal_component_1": -2.3398678340357373, "principal_component_2": -1.6986128186717833, "log10_total_count": 4.562423728006818}, {"clade": "21K (Omicron BA.1)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 51666, "AtoC": 0.01368404753609724, "AtoG": 0.10751751635504975, "AtoT": 0.03373591917315062, "CtoA": 0.0265551813571788, "CtoG": 0.002709712383385592, "CtoT": 0.4149924515155034, "GtoA": 0.05822010606588472, "GtoC": 0.0054774900321294465, "GtoT": 0.07149769674447412, "TtoA": 0.04691673440947625, "TtoC": 0.19616382146866412, "TtoG": 0.022529322959005924, "principal_component_1": -2.4796865405476813, "principal_component_2": -0.3144090931865054, "log10_total_count": 4.713204839614709}, {"clade": "21L (Omicron BA.2)", "subset": "England", "partition": "all", "excluded": "no", "total_count": 27649, "AtoC": 0.012080002893413867, "AtoG": 0.10441607291402943, "AtoT": 0.02965749213353105, "CtoA": 0.028572461933523818, "CtoG": 0.0035082643133567217, "CtoT": 0.43527794856956853, "GtoA": 0.05323881514702159, "GtoC": 0.006727187240044848, "GtoT": 0.0806900792072046, "TtoA": 0.04032695576693551, "TtoC": 0.1797895041411986, "TtoG": 0.025715215740171434, "principal_component_1": -1.3566614464952342, "principal_component_2": -0.4868140132075368, "log10_total_count": 4.441679428503808}, {"clade": "21L (Omicron BA.2)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 21464, "AtoC": 0.014303019008572494, "AtoG": 0.11032426388371226, "AtoT": 0.030795751024972045, "CtoA": 0.028792396571002608, "CtoG": 0.0033078643309727915, "CtoT": 0.4444651509504286, "GtoA": 0.05390421170331718, "GtoC": 0.005357808423406635, "GtoT": 0.0776183376816996, "TtoA": 0.039973909802459934, "TtoC": 0.16953969437197167, "TtoG": 0.02161759224748416, "principal_component_1": -1.616661074356611, "principal_component_2": -0.388590360526452, "log10_total_count": 4.331710659663882}, {"clade": "22A (Omicron BA.4)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 8521, "AtoC": 0.009036498063607557, "AtoG": 0.11172397605914798, "AtoT": 0.02992606501584321, "CtoA": 0.026874779955404295, "CtoG": 0.003403356413566483, "CtoT": 0.4371552634667293, "GtoA": 0.06384227203379884, "GtoC": 0.0044595704729491845, "GtoT": 0.08144583969017721, "TtoA": 0.04060556272737942, "TtoC": 0.1715761060908344, "TtoG": 0.01995071001056214, "principal_component_1": -2.090258736885315, "principal_component_2": -2.3742343921169575, "log10_total_count": 3.930490565306269}, {"clade": "22B (Omicron BA.5)", "subset": "England", "partition": "all", "excluded": "no", "total_count": 13152, "AtoC": 0.010948905109489052, "AtoG": 0.10196167883211679, "AtoT": 0.02729622871046229, "CtoA": 0.026307785888077858, "CtoG": 0.0038017031630170318, "CtoT": 0.4212287104622871, "GtoA": 0.061891727493917276, "GtoC": 0.007375304136253041, "GtoT": 0.09930048661800486, "TtoA": 0.04356751824817518, "TtoC": 0.17411800486618004, "TtoG": 0.022201946472019465, "principal_component_1": -1.8024250736098908, "principal_component_2": -0.7422452247638454, "log10_total_count": 4.118991800195975}, {"clade": "22B (Omicron BA.5)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 44110, "AtoC": 0.010451144865109953, "AtoG": 0.10605304919519383, "AtoT": 0.028202221718431196, "CtoA": 0.02727272727272727, "CtoG": 0.0031738834731353436, "CtoT": 0.42187712536839717, "GtoA": 0.06973475402403083, "GtoC": 0.006710496486057583, "GtoT": 0.08431194740421673, "TtoA": 0.04239401496259352, "TtoC": 0.17794150986170937, "TtoG": 0.02187712536839719, "principal_component_1": -2.441565524162199, "principal_component_2": -1.2115699600696297, "log10_total_count": 4.644537057778407}, {"clade": "22C (Omicron BA.2.12.1)", "subset": "USA", "partition": "all", "excluded": "no", "total_count": 18167, "AtoC": 0.01023834425056421, "AtoG": 0.11752077943523973, "AtoT": 0.02724720647327572, "CtoA": 0.026091264380470082, "CtoG": 0.003192601970606044, "CtoT": 0.42445092750591734, "GtoA": 0.05482468211592448, "GtoC": 0.005834755325590356, "GtoT": 0.0849342213904332, "TtoA": 0.03781581989321297, "TtoC": 0.18539109374139923, "TtoG": 0.022458303517366655, "principal_component_1": -1.7049389644647706, "principal_component_2": -1.0259545640700094, "log10_total_count": 4.259283216189963}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>