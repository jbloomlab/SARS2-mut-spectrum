<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.17.0"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "axis": {"grid": false}, "legend": {"columns": 1}}, "data": {"name": "data-af01a27b9f674f443fc9de60bc317eff"}, "mark": {"type": "point", "filled": true, "stroke": "black"}, "encoding": {"color": {"field": "clade", "scale": {"domain": ["20A (B.1)", "20B (B.1.1)", "20C (B.1.367)", "20E (B.1.177)", "20G (B.1.2)", "20I (Alpha)", "21C (Epsilon)", "21I (Delta)", "21J (Delta)", "21K (Omicron BA.1)", "21L (Omicron BA.2)", "22A (Omicron BA.4)", "22B (Omicron BA.5)", "22C (Omicron BA.2.12.1)"], "scheme": "viridis"}, "type": "nominal"}, "opacity": {"condition": {"value": 0.9, "selection": "selector006"}, "value": 0.45}, "shape": {"field": "excluded", "scale": {"domain": ["no", "yes"]}, "title": "exclude top 5 mutations/clade", "type": "nominal"}, "size": {"condition": {"value": 65, "selection": "selector006"}, "value": 45}, "strokeWidth": {"condition": {"value": 1.5, "selection": "selector006"}, "value": 0}, "tooltip": [{"field": "clade", "type": "nominal"}, {"field": "total_count", "type": "quantitative"}, {"field": "excluded", "title": "exclude top 5 mutations/clade", "type": "nominal"}], "x": {"axis": {"labels": false, "ticks": false}, "field": "principal_component_2", "scale": {"nice": false, "padding": 10}, "title": "PC2 (27% variance)", "type": "quantitative"}, "y": {"axis": {"labels": false, "ticks": false}, "field": "principal_component_1", "scale": {"nice": false, "padding": 10}, "title": "PC1 (37% variance)", "type": "quantitative"}}, "height": 300, "selection": {"selector006": {"type": "multi", "fields": ["clade"], "bind": "legend"}, "selector007": {"type": "multi", "fields": ["excluded"], "bind": "legend"}}, "title": "all samples, whole genome, +/- top mutations", "transform": [{"filter": {"selection": "selector007"}}], "width": 218.1935312362354, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-af01a27b9f674f443fc9de60bc317eff": [{"clade": "20A (B.1)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 17202, "AtoC": 0.016625973723985582, "AtoG": 0.09400069759330311, "AtoT": 0.02993837925822579, "CtoA": 0.0197070108126962, "CtoG": 0.007557260783629811, "CtoT": 0.413498430415068, "GtoA": 0.04865713289152424, "GtoC": 0.007964190210440647, "GtoT": 0.15521450994070457, "TtoA": 0.03284501802116033, "TtoC": 0.15102895012207881, "TtoG": 0.022962446227182885, "principal_component_1": -2.752230756427783, "principal_component_2": 0.5016273432197628, "log10_total_count": 4.235578943330128}, {"clade": "20A (B.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 15734, "AtoC": 0.01290199567814923, "AtoG": 0.09705097241642303, "AtoT": 0.03273166391254608, "CtoA": 0.021545697216219652, "CtoG": 0.0041947375111224105, "CtoT": 0.3769543663404093, "GtoA": 0.05319689843650693, "GtoC": 0.00864370153807042, "GtoT": 0.16937841616880642, "TtoA": 0.03419346637854328, "TtoC": 0.16435744248125078, "TtoG": 0.02485064192195246, "principal_component_1": -1.2873567639737213, "principal_component_2": 1.6437803527651147, "log10_total_count": 4.1968391458331125}, {"clade": "20B (B.1.1)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 14121, "AtoC": 0.010976559733729905, "AtoG": 0.09121167056157496, "AtoT": 0.028397422278875435, "CtoA": 0.01989944054953615, "CtoG": 0.005948587210537497, "CtoT": 0.423978471779619, "GtoA": 0.04440195453579775, "GtoC": 0.006940018412293747, "GtoT": 0.15933715742511154, "TtoA": 0.03193824799943347, "TtoC": 0.15211387295517315, "TtoG": 0.0248565965583174, "principal_component_1": -3.1830563797933853, "principal_component_2": -0.9572395747633947, "log10_total_count": 4.149865453026262}, {"clade": "20B (B.1.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 12933, "AtoC": 0.011984844970231192, "AtoG": 0.09634268924456815, "AtoT": 0.03100595376169489, "CtoA": 0.021727364107322355, "CtoG": 0.0027062553158586564, "CtoT": 0.3813500347947112, "GtoA": 0.0484806309440965, "GtoC": 0.007577514884404237, "GtoT": 0.1730456970540478, "TtoA": 0.033170958014381816, "TtoC": 0.16577746849145597, "TtoG": 0.026830588417227248, "principal_component_1": -1.8564344612628274, "principal_component_2": 1.2637942903540453, "log10_total_count": 4.111699277573551}, {"clade": "20C (B.1.367)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 9344, "AtoC": 0.013163527397260275, "AtoG": 0.10113441780821918, "AtoT": 0.028253424657534245, "CtoA": 0.023330479452054794, "CtoG": 0.002889554794520548, "CtoT": 0.4134203767123288, "GtoA": 0.0507277397260274, "GtoC": 0.007170376712328767, "GtoT": 0.14972174657534246, "TtoA": 0.03617294520547945, "TtoC": 0.14982876712328766, "TtoG": 0.024186643835616438, "principal_component_1": -1.5586018099879348, "principal_component_2": -0.3334265310436034, "log10_total_count": 3.9705328297683247}, {"clade": "20C (B.1.367)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 8566, "AtoC": 0.014242353490544011, "AtoG": 0.1098529068409993, "AtoT": 0.030819519028718188, "CtoA": 0.025449451319168807, "CtoG": 0.003151996264300724, "CtoT": 0.3719355591874854, "GtoA": 0.055218304926453424, "GtoC": 0.007821620359561056, "GtoT": 0.16273639971982257, "TtoA": 0.03759047396684567, "TtoC": 0.15479803875787998, "TtoG": 0.026383376138220872, "principal_component_1": -0.44221441915216325, "principal_component_2": 1.813817930343732, "log10_total_count": 3.9327780700605506}, {"clade": "20E (B.1.177)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 10454, "AtoC": 0.013105031566864359, "AtoG": 0.1057011670174096, "AtoT": 0.028601492251769656, "CtoA": 0.020470633250430456, "CtoG": 0.01138320260187488, "CtoT": 0.43916204323703845, "GtoA": 0.04323703845418022, "GtoC": 0.004591543906638607, "GtoT": 0.12559785727951023, "TtoA": 0.03472355079395447, "TtoC": 0.1509470059307442, "TtoG": 0.02247943370958485, "principal_component_1": -2.5151952764854992, "principal_component_2": -2.351697560434885, "log10_total_count": 4.019282495761732}, {"clade": "20E (B.1.177)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 9469, "AtoC": 0.014468264864294013, "AtoG": 0.10581898827753723, "AtoT": 0.031576724046889854, "CtoA": 0.02260006336466364, "CtoG": 0.0028514098637659733, "CtoT": 0.40352729960925127, "GtoA": 0.047734713274897034, "GtoC": 0.005069173091139508, "GtoT": 0.13824057450628366, "TtoA": 0.0368571126834935, "TtoC": 0.16643784982574716, "TtoG": 0.024817826592037174, "principal_component_1": -1.0466123583175688, "principal_component_2": -0.028601412018452267, "log10_total_count": 3.976304116552003}, {"clade": "20G (B.1.2)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 14019, "AtoC": 0.012126399885869178, "AtoG": 0.09137598972822598, "AtoT": 0.03274127969184678, "CtoA": 0.0211855339182538, "CtoG": 0.0025679435052428845, "CtoT": 0.44432555817105357, "GtoA": 0.05057422070047792, "GtoC": 0.005064555246451245, "GtoT": 0.13581567872173478, "TtoA": 0.03495256437691704, "TtoC": 0.14523147157429203, "TtoG": 0.02403880447963478, "principal_component_1": -2.218578130439977, "principal_component_2": -1.3689390575270062, "log10_total_count": 4.1467170357439755}, {"clade": "20G (B.1.2)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 12966, "AtoC": 0.013111213944161653, "AtoG": 0.09848835415702607, "AtoT": 0.035400277649236464, "CtoA": 0.022906062008329477, "CtoG": 0.002699367576739164, "CtoT": 0.4024371432978559, "GtoA": 0.054681474625944776, "GtoC": 0.005475859941385161, "GtoT": 0.1458429739318217, "TtoA": 0.03648002467993213, "TtoC": 0.1565633194508715, "TtoG": 0.025913928736695974, "principal_component_1": -0.9994812432241239, "principal_component_2": 0.5936559996347134, "log10_total_count": 4.112806017266886}, {"clade": "20I (Alpha)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 60858, "AtoC": 0.011633638962831509, "AtoG": 0.09780143941634625, "AtoT": 0.02862400999046962, "CtoA": 0.0221006276906898, "CtoG": 0.015708698938512605, "CtoT": 0.43294225902921557, "GtoA": 0.04530217884255151, "GtoC": 0.0051924151303033295, "GtoT": 0.13595583160800553, "TtoA": 0.03458871471293831, "TtoC": 0.1456176673567978, "TtoG": 0.0245325183213382, "principal_component_1": -3.0001802971907185, "principal_component_2": -2.127482731262896, "log10_total_count": 4.784317675869076}, {"clade": "20I (Alpha)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 54803, "AtoC": 0.012827764903381202, "AtoG": 0.10360746674452129, "AtoT": 0.03178658102658614, "CtoA": 0.024542452055544405, "CtoG": 0.0030290312574129154, "CtoT": 0.40335383099465355, "GtoA": 0.05030746491980366, "GtoC": 0.005747860518584749, "GtoT": 0.1503749794719267, "TtoA": 0.03448716311150849, "TtoC": 0.15526522270678614, "TtoG": 0.024670182289290733, "principal_component_1": -1.13847011185632, "principal_component_2": 0.1304854741457002, "log10_total_count": 4.738804333078971}, {"clade": "21C (Epsilon)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 6308, "AtoC": 0.012840837032339885, "AtoG": 0.09004438807863031, "AtoT": 0.0326569435637286, "CtoA": 0.022828154724159798, "CtoG": 0.004121750158528852, "CtoT": 0.4384908053265694, "GtoA": 0.04803424223208624, "GtoC": 0.004597336715282181, "GtoT": 0.1322130627774255, "TtoA": 0.035827520608750794, "TtoC": 0.15076093849080532, "TtoG": 0.027584020291693087, "principal_component_1": -2.4187837380008803, "principal_component_2": -0.7951994401054523, "log10_total_count": 3.7998916846568656}, {"clade": "21C (Epsilon)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 5804, "AtoC": 0.013955892487939351, "AtoG": 0.09734665747760166, "AtoT": 0.03549276361130255, "CtoA": 0.024810475534114404, "CtoG": 0.00430737422467264, "CtoT": 0.392315644383184, "GtoA": 0.05220537560303239, "GtoC": 0.0049965541006202615, "GtoT": 0.14369400413507927, "TtoA": 0.037215713301171606, "TtoC": 0.16368022053756032, "TtoG": 0.02997932460372157, "principal_component_1": -1.1529744468514238, "principal_component_2": 1.4119947360390068, "log10_total_count": 3.7637274037656985}, {"clade": "21I (Delta)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 24117, "AtoC": 0.014471119956876891, "AtoG": 0.11639092756147117, "AtoT": 0.032383795662810466, "CtoA": 0.02715926524857984, "CtoG": 0.007463614877472323, "CtoT": 0.3789443131401086, "GtoA": 0.05307459468424763, "GtoC": 0.00725629224198698, "GtoT": 0.15184309822946468, "TtoA": 0.027325123356968115, "TtoC": 0.15851888709209272, "TtoG": 0.025168967947920555, "principal_component_1": -0.4661995202139017, "principal_component_2": 2.040139734514141, "log10_total_count": 4.382323283381981}, {"clade": "21I (Delta)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 22283, "AtoC": 0.014989005071130459, "AtoG": 0.12125835838980388, "AtoT": 0.035049140600457745, "CtoA": 0.02939460575326482, "CtoG": 0.0034106718125925593, "CtoT": 0.3425930081227842, "GtoA": 0.05744289368576942, "GtoC": 0.007853520621101288, "GtoT": 0.16330835165821478, "TtoA": 0.027420006282816496, "TtoC": 0.1712965040613921, "TtoG": 0.025983933940672263, "principal_component_1": 0.9881970272048529, "principal_component_2": 3.9383400251154765, "log10_total_count": 4.347973660278038}, {"clade": "21J (Delta)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 282051, "AtoC": 0.015408560863106317, "AtoG": 0.11302565848020393, "AtoT": 0.03223530496257769, "CtoA": 0.028228937319846412, "CtoG": 0.010870374506738143, "CtoT": 0.3771587407951044, "GtoA": 0.05124605124605124, "GtoC": 0.0070519161428252335, "GtoT": 0.14745914745914745, "TtoA": 0.027041208859390677, "TtoC": 0.16766471311925857, "TtoG": 0.02260938624574988, "principal_component_1": -0.3271804567312786, "principal_component_2": 1.6108758368921403, "log10_total_count": 5.450327643837027}, {"clade": "21J (Delta)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 260612, "AtoC": 0.015989286755790217, "AtoG": 0.11893926603533221, "AtoT": 0.03488711187512471, "CtoA": 0.030551164182769788, "CtoG": 0.0033728301075928967, "CtoT": 0.3439519285374426, "GtoA": 0.0554579221217749, "GtoC": 0.007624361119211702, "GtoT": 0.1557833100547941, "TtoA": 0.028106917563274138, "TtoC": 0.18100087486378216, "TtoG": 0.024335026783110524, "principal_component_1": 1.3242138814528497, "principal_component_2": 3.6679211484244165, "log10_total_count": 5.415994409127132}, {"clade": "21K (Omicron BA.1)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 113721, "AtoC": 0.0138320978535187, "AtoG": 0.10859032192822786, "AtoT": 0.03364374214085349, "CtoA": 0.02737401183598456, "CtoG": 0.006665435583577351, "CtoT": 0.4120259230924807, "GtoA": 0.056409985842544474, "GtoC": 0.005636601858935465, "GtoT": 0.07042674615946043, "TtoA": 0.054026960719656, "TtoC": 0.18837329956648288, "TtoG": 0.022994873418278067, "principal_component_1": 2.277064518092621, "principal_component_2": -1.6678550786475776, "log10_total_count": 5.055840669982285}, {"clade": "21K (Omicron BA.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 104035, "AtoC": 0.015023790070649301, "AtoG": 0.11647041860912193, "AtoT": 0.036776084971403854, "CtoA": 0.02992262219445379, "CtoG": 0.0032200701686932284, "CtoT": 0.38123708367376363, "GtoA": 0.061661940693035995, "GtoC": 0.006132551545153074, "GtoT": 0.07659922141586965, "TtoA": 0.04260104772432354, "TtoC": 0.20522900946796752, "TtoG": 0.025126159465564474, "principal_component_1": 3.443496721624796, "principal_component_2": 1.1282438386497462, "log10_total_count": 5.0171794715074}, {"clade": "21L (Omicron BA.2)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 83475, "AtoC": 0.013584905660377358, "AtoG": 0.10996106618748128, "AtoT": 0.03018867924528302, "CtoA": 0.02998502545672357, "CtoG": 0.010757711889787362, "CtoT": 0.4262114405510632, "GtoA": 0.0537047020065888, "GtoC": 0.006433063791554358, "GtoT": 0.0795926924228811, "TtoA": 0.04064690026954178, "TtoC": 0.17538185085354896, "TtoG": 0.02355196166516921, "principal_component_1": 0.9949586419065883, "principal_component_2": -1.387499480874238, "log10_total_count": 4.921556427726409}, {"clade": "21L (Omicron BA.2)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 76516, "AtoC": 0.014702807255998745, "AtoG": 0.11630247268545141, "AtoT": 0.03293428825343719, "CtoA": 0.032712112499346545, "CtoG": 0.0036201578754770244, "CtoT": 0.39246693502012653, "GtoA": 0.058575984107899, "GtoC": 0.007018139996863401, "GtoT": 0.08637409169324063, "TtoA": 0.038959171937895345, "TtoC": 0.19067907365779707, "TtoG": 0.025654765016467143, "principal_component_1": 2.6444202655095688, "principal_component_2": 1.0116934035704657, "log10_total_count": 4.883752258488901}, {"clade": "22A (Omicron BA.4)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 11413, "AtoC": 0.009112415666345396, "AtoG": 0.10952422675895908, "AtoT": 0.029264873389993867, "CtoA": 0.027337246999036186, "CtoG": 0.003066678349250854, "CtoT": 0.43170069219311313, "GtoA": 0.062209760799088756, "GtoC": 0.004994304740208534, "GtoT": 0.08639271006746692, "TtoA": 0.040129676684482606, "TtoC": 0.17620257600981337, "TtoG": 0.020064838342241303, "principal_component_1": 1.9330372443925103, "principal_component_2": -3.253366525661179, "log10_total_count": 4.057399817266062}, {"clade": "22A (Omicron BA.4)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 10510, "AtoC": 0.009895337773549001, "AtoG": 0.11874405328258801, "AtoT": 0.03177925784966698, "CtoA": 0.029686013320647003, "CtoG": 0.003330161750713606, "CtoT": 0.38763082778306374, "GtoA": 0.0675547098001903, "GtoC": 0.005423406279733587, "GtoT": 0.09362511893434824, "TtoA": 0.039581351094196006, "TtoC": 0.19096098953377735, "TtoG": 0.021788772597526165, "principal_component_1": 3.4503440127243556, "principal_component_2": -1.1993798737667252, "log10_total_count": 4.021602716028243}, {"clade": "22B (Omicron BA.5)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 64765, "AtoC": 0.010190689415579402, "AtoG": 0.10516482668107774, "AtoT": 0.028642013433181502, "CtoA": 0.026820041689183973, "CtoG": 0.00335057515633444, "CtoT": 0.41716976762140046, "GtoA": 0.06613139813170694, "GtoC": 0.006886435574770323, "GtoT": 0.09089786149926658, "TtoA": 0.043202346946653286, "TtoC": 0.17977302555392574, "TtoG": 0.02177101829691963, "principal_component_1": 2.0732653885613033, "principal_component_2": -2.221982252204257, "log10_total_count": 4.811340369861851}, {"clade": "22B (Omicron BA.5)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 59458, "AtoC": 0.010999360893403747, "AtoG": 0.11419825759359548, "AtoT": 0.031198493053920414, "CtoA": 0.029213898886609035, "CtoG": 0.0036328164418581183, "CtoT": 0.38020115039187324, "GtoA": 0.06315382286656127, "GtoC": 0.007501093208651485, "GtoT": 0.09872515052642201, "TtoA": 0.04224830973123886, "TtoC": 0.19526388374987386, "TtoG": 0.023663762655992467, "principal_component_1": 2.9486758803664515, "principal_component_2": -0.17204085457730867, "log10_total_count": 4.774210296668918}, {"clade": "22C (Omicron BA.2.12.1)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 18958, "AtoC": 0.010074902415866652, "AtoG": 0.11678447093575271, "AtoT": 0.027640046418398564, "CtoA": 0.026110349192952843, "CtoG": 0.003164890811267011, "CtoT": 0.42430636143053063, "GtoA": 0.05485810739529486, "GtoC": 0.00569680346028062, "GtoT": 0.08524105918345817, "TtoA": 0.03760945247388965, "TtoC": 0.18609557970250026, "TtoG": 0.022417976579807996, "principal_component_1": 1.4840642748754986, "principal_component_2": -2.390546710967044, "log10_total_count": 4.2777925189314425}, {"clade": "22C (Omicron BA.2.12.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 17542, "AtoC": 0.01083114810169878, "AtoG": 0.12558431193706532, "AtoT": 0.029871166343632426, "CtoA": 0.028217991107057347, "CtoG": 0.003420362558431194, "CtoT": 0.38866719872306466, "GtoA": 0.059286284346140694, "GtoC": 0.006156652605176149, "GtoT": 0.0876752935811196, "TtoA": 0.035685782692965455, "TtoC": 0.20037623988142744, "TtoG": 0.024227568122220957, "principal_component_1": 2.801812313198111, "principal_component_2": -0.5011130298144463, "log10_total_count": 4.244079106672388}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>