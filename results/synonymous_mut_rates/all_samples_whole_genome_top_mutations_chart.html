<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.17.0"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "axis": {"grid": false}, "legend": {"columns": 1}}, "data": {"name": "data-93595180c768935db08b3f83beaafcd9"}, "mark": {"type": "point", "filled": true, "stroke": "black"}, "encoding": {"color": {"field": "clade", "scale": {"domain": ["20A (B.1)", "20B (B.1.1)", "20C (B.1.367)", "20E (B.1.177)", "20G (B.1.2)", "20I (Alpha)", "21C (Epsilon)", "21I (Delta)", "21J (Delta)", "21K (Omicron BA.1)", "21L (Omicron BA.2)", "22A (Omicron BA.4)", "22B (Omicron BA.5)", "22C (Omicron BA.2.12.1)"], "scheme": "viridis"}, "type": "nominal"}, "opacity": {"condition": {"value": 0.9, "selection": "selector006"}, "value": 0.45}, "shape": {"field": "excluded", "scale": {"domain": ["yes"]}, "title": "exclude top 5 mutations/clade", "type": "nominal"}, "size": {"condition": {"value": 65, "selection": "selector006"}, "value": 45}, "strokeWidth": {"condition": {"value": 1.5, "selection": "selector006"}, "value": 0}, "tooltip": [{"field": "clade", "type": "nominal"}, {"field": "total_count", "type": "quantitative"}, {"field": "excluded", "title": "exclude top 5 mutations/clade", "type": "nominal"}], "x": {"axis": {"labels": false, "ticks": false}, "field": "principal_component_2", "scale": {"nice": false, "padding": 10}, "title": "PC2 (23% variance)", "type": "quantitative"}, "y": {"axis": {"labels": false, "ticks": false}, "field": "principal_component_1", "scale": {"nice": false, "padding": 10}, "title": "PC1 (38% variance)", "type": "quantitative"}}, "height": 300, "selection": {"selector006": {"type": "multi", "fields": ["clade"], "bind": "legend"}, "selector007": {"type": "multi", "fields": ["excluded"], "bind": "legend"}}, "title": "all samples, whole genome, +/- top mutations", "transform": [{"filter": {"selection": "selector007"}}], "width": 184.02535580737043, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-93595180c768935db08b3f83beaafcd9": [{"clade": "20A (B.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 15734, "AtoC": 0.01290199567814923, "AtoG": 0.09705097241642303, "AtoT": 0.03273166391254608, "CtoA": 0.021545697216219652, "CtoG": 0.0041947375111224105, "CtoT": 0.3769543663404093, "GtoA": 0.05319689843650693, "GtoC": 0.00864370153807042, "GtoT": 0.16937841616880642, "TtoA": 0.03419346637854328, "TtoC": 0.16435744248125078, "TtoG": 0.02485064192195246, "principal_component_1": -1.9538969954379035, "principal_component_2": 0.6146189195253733, "log10_total_count": 4.196839145833112}, {"clade": "20B (B.1.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 12933, "AtoC": 0.011984844970231192, "AtoG": 0.09634268924456815, "AtoT": 0.03100595376169489, "CtoA": 0.021727364107322355, "CtoG": 0.0027062553158586564, "CtoT": 0.3813500347947112, "GtoA": 0.0484806309440965, "GtoC": 0.007577514884404237, "GtoT": 0.1730456970540478, "TtoA": 0.033170958014381816, "TtoC": 0.16577746849145597, "TtoG": 0.026830588417227248, "principal_component_1": -2.800193879643012, "principal_component_2": -0.6501171623183628, "log10_total_count": 4.11169927757355}, {"clade": "20C (B.1.367)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 8566, "AtoC": 0.014242353490544011, "AtoG": 0.1098529068409993, "AtoT": 0.030819519028718188, "CtoA": 0.025449451319168807, "CtoG": 0.003151996264300724, "CtoT": 0.3719355591874854, "GtoA": 0.055218304926453424, "GtoC": 0.007821620359561056, "GtoT": 0.16273639971982257, "TtoA": 0.03759047396684567, "TtoC": 0.15479803875787998, "TtoG": 0.026383376138220872, "principal_component_1": -1.3086365461734162, "principal_component_2": 0.47831309233447, "log10_total_count": 3.9327780700605497}, {"clade": "20E (B.1.177)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 9469, "AtoC": 0.014468264864294013, "AtoG": 0.10581898827753723, "AtoT": 0.031576724046889854, "CtoA": 0.02260006336466364, "CtoG": 0.0028514098637659733, "CtoT": 0.40352729960925127, "GtoA": 0.047734713274897034, "GtoC": 0.005069173091139508, "GtoT": 0.13824057450628366, "TtoA": 0.0368571126834935, "TtoC": 0.16643784982574716, "TtoG": 0.024817826592037174, "principal_component_1": -1.5826491070992121, "principal_component_2": -1.815717764899255, "log10_total_count": 3.976304116552002}, {"clade": "20G (B.1.2)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 12966, "AtoC": 0.013111213944161653, "AtoG": 0.09848835415702607, "AtoT": 0.035400277649236464, "CtoA": 0.022906062008329477, "CtoG": 0.002699367576739164, "CtoT": 0.4024371432978559, "GtoA": 0.054681474625944776, "GtoC": 0.005475859941385161, "GtoT": 0.1458429739318217, "TtoA": 0.03648002467993213, "TtoC": 0.1565633194508715, "TtoG": 0.025913928736695974, "principal_component_1": -1.8220590801909895, "principal_component_2": -1.5204726767339647, "log10_total_count": 4.112806017266885}, {"clade": "20I (Alpha)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 54803, "AtoC": 0.012827764903381202, "AtoG": 0.10360746674452129, "AtoT": 0.03178658102658614, "CtoA": 0.024542452055544405, "CtoG": 0.0030290312574129154, "CtoT": 0.40335383099465355, "GtoA": 0.05030746491980366, "GtoC": 0.005747860518584749, "GtoT": 0.1503749794719267, "TtoA": 0.03448716311150849, "TtoC": 0.15526522270678614, "TtoG": 0.024670182289290733, "principal_component_1": -1.6515673055817945, "principal_component_2": -1.4918107576108373, "log10_total_count": 4.73880433307897}, {"clade": "21C (Epsilon)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 5804, "AtoC": 0.013955892487939351, "AtoG": 0.09734665747760166, "AtoT": 0.03549276361130255, "CtoA": 0.024810475534114404, "CtoG": 0.00430737422467264, "CtoT": 0.392315644383184, "GtoA": 0.05220537560303239, "GtoC": 0.0049965541006202615, "GtoT": 0.14369400413507927, "TtoA": 0.037215713301171606, "TtoC": 0.16368022053756032, "TtoG": 0.02997932460372157, "principal_component_1": -2.094033379555196, "principal_component_2": -0.45512480099502195, "log10_total_count": 3.7637274037656976}, {"clade": "21I (Delta)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 22283, "AtoC": 0.014989005071130459, "AtoG": 0.12125835838980388, "AtoT": 0.035049140600457745, "CtoA": 0.02939460575326482, "CtoG": 0.0034106718125925593, "CtoT": 0.3425930081227842, "GtoA": 0.05744289368576942, "GtoC": 0.007853520621101288, "GtoT": 0.16330835165821478, "TtoA": 0.027420006282816496, "TtoC": 0.1712965040613921, "TtoG": 0.025983933940672263, "principal_component_1": -0.3623224721164428, "principal_component_2": 3.6693214180856146, "log10_total_count": 4.347973660278038}, {"clade": "21J (Delta)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 260612, "AtoC": 0.015989286755790217, "AtoG": 0.11893926603533221, "AtoT": 0.03488711187512471, "CtoA": 0.030551164182769788, "CtoG": 0.0033728301075928967, "CtoT": 0.3439519285374426, "GtoA": 0.0554579221217749, "GtoC": 0.007624361119211702, "GtoT": 0.1557833100547941, "TtoA": 0.028106917563274138, "TtoC": 0.18100087486378216, "TtoG": 0.024335026783110524, "principal_component_1": 0.08180841790698794, "principal_component_2": 3.6053193764515408, "log10_total_count": 5.415994409127131}, {"clade": "21K (Omicron BA.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 104035, "AtoC": 0.015023790070649301, "AtoG": 0.11647041860912193, "AtoT": 0.036776084971403854, "CtoA": 0.02992262219445379, "CtoG": 0.0032200701686932284, "CtoT": 0.38123708367376363, "GtoA": 0.061661940693035995, "GtoC": 0.006132551545153074, "GtoT": 0.07659922141586965, "TtoA": 0.04260104772432354, "TtoC": 0.20522900946796752, "TtoG": 0.025126159465564474, "principal_component_1": 2.62286736161095, "principal_component_2": 0.2750649623688409, "log10_total_count": 5.017179471507399}, {"clade": "21L (Omicron BA.2)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 76516, "AtoC": 0.014702807255998745, "AtoG": 0.11630247268545141, "AtoT": 0.03293428825343719, "CtoA": 0.032712112499346545, "CtoG": 0.0036201578754770244, "CtoT": 0.39246693502012653, "GtoA": 0.058575984107899, "GtoC": 0.007018139996863401, "GtoT": 0.08637409169324063, "TtoA": 0.038959171937895345, "TtoC": 0.19067907365779707, "TtoG": 0.025654765016467143, "principal_component_1": 2.010014860201192, "principal_component_2": 0.35617618363680664, "log10_total_count": 4.8837522584889}, {"clade": "22A (Omicron BA.4)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 10510, "AtoC": 0.009895337773549001, "AtoG": 0.11874405328258801, "AtoT": 0.03177925784966698, "CtoA": 0.029686013320647003, "CtoG": 0.003330161750713606, "CtoT": 0.38763082778306374, "GtoA": 0.0675547098001903, "GtoC": 0.005423406279733587, "GtoT": 0.09362511893434824, "TtoA": 0.039581351094196006, "TtoC": 0.19096098953377735, "TtoG": 0.021788772597526165, "principal_component_1": 3.5125640210974844, "principal_component_2": -1.516948719579135, "log10_total_count": 4.021602716028242}, {"clade": "22B (Omicron BA.5)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 59458, "AtoC": 0.010999360893403747, "AtoG": 0.11419825759359548, "AtoT": 0.031198493053920414, "CtoA": 0.029213898886609035, "CtoG": 0.0036328164418581183, "CtoT": 0.38020115039187324, "GtoA": 0.06315382286656127, "GtoC": 0.007501093208651485, "GtoT": 0.09872515052642201, "TtoA": 0.04224830973123886, "TtoC": 0.19526388374987386, "TtoG": 0.023663762655992467, "principal_component_1": 2.723816219275977, "principal_component_2": -0.6526599649494048, "log10_total_count": 4.774210296668917}, {"clade": "22C (Omicron BA.2.12.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 17542, "AtoC": 0.01083114810169878, "AtoG": 0.12558431193706532, "AtoT": 0.029871166343632426, "CtoA": 0.028217991107057347, "CtoG": 0.003420362558431194, "CtoT": 0.38866719872306466, "GtoA": 0.059286284346140694, "GtoC": 0.006156652605176149, "GtoT": 0.0876752935811196, "TtoA": 0.035685782692965455, "TtoC": 0.20037623988142744, "TtoG": 0.024227568122220957, "principal_component_1": 2.6242878857053733, "principal_component_2": -0.8959621053166655, "log10_total_count": 4.2440791066723875}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>