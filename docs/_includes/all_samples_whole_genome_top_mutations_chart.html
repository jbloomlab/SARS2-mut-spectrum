<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.17.0"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "axis": {"grid": false}, "legend": {"columns": 1}}, "data": {"name": "data-2f4760f43b2f965ea42f6078a4281483"}, "mark": {"type": "point", "filled": true, "stroke": "black"}, "encoding": {"color": {"field": "clade", "scale": {"domain": ["20A (B.1)", "20B (B.1.1)", "20C (B.1.367)", "20E (B.1.177)", "20G (B.1.2)", "20I (Alpha)", "21C (Epsilon)", "21I (Delta)", "21J (Delta)", "21K (Omicron BA.1)", "21M (Omicron)", "22A (Omicron BA.4)", "22B (Omicron BA.5)", "22C (Omicron BA.2.12.1)"], "scheme": "viridis"}, "type": "nominal"}, "opacity": {"condition": {"value": 0.9, "selection": "selector006"}, "value": 0.45}, "shape": {"field": "excluded", "scale": {"domain": ["no", "yes"]}, "title": "exclude top 5 mutations/clade", "type": "nominal"}, "size": {"condition": {"value": 65, "selection": "selector006"}, "value": 45}, "strokeWidth": {"condition": {"value": 1.5, "selection": "selector006"}, "value": 0}, "tooltip": [{"field": "clade", "type": "nominal"}, {"field": "total_count", "type": "quantitative"}, {"field": "excluded", "title": "exclude top 5 mutations/clade", "type": "nominal"}], "x": {"axis": {"labels": false, "ticks": false}, "field": "principal_component_2", "scale": {"nice": false, "padding": 10}, "title": "PC2 (26% variance)", "type": "quantitative"}, "y": {"axis": {"labels": false, "ticks": false}, "field": "principal_component_1", "scale": {"nice": false, "padding": 10}, "title": "PC1 (37% variance)", "type": "quantitative"}}, "height": 300, "selection": {"selector006": {"type": "multi", "fields": ["clade"], "bind": "legend"}, "selector007": {"type": "multi", "fields": ["excluded"], "bind": "legend"}}, "title": "all samples, whole genome, +/- top mutations", "transform": [{"filter": {"selection": "selector007"}}], "width": 212.5872654771793, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-2f4760f43b2f965ea42f6078a4281483": [{"clade": "20A (B.1)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 17089, "AtoC": 0.01661887764058751, "AtoG": 0.09409561706360817, "AtoT": 0.02990227631809936, "CtoA": 0.01960325355491837, "CtoG": 0.007607232722804143, "CtoT": 0.4134823570718006, "GtoA": 0.04851073790157411, "GtoC": 0.008016852946339751, "GtoT": 0.15524606471999533, "TtoA": 0.032828135057639415, "TtoC": 0.15120837965943004, "TtoG": 0.02288021534320323, "principal_component_1": -2.7486150284994424, "principal_component_2": 0.5549250775744864, "log10_total_count": 4.232716649778168}, {"clade": "20A (B.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 15705, "AtoC": 0.01279847182425979, "AtoG": 0.09665711556829035, "AtoT": 0.03253740846864056, "CtoA": 0.021330786373766317, "CtoG": 0.004202483285577842, "CtoT": 0.3800063673989175, "GtoA": 0.05278573702642471, "GtoC": 0.008659662527857371, "GtoT": 0.16860872333651702, "TtoA": 0.03400191021967526, "TtoC": 0.16376950015918498, "TtoG": 0.02464183381088825, "principal_component_1": -1.3512864097172472, "principal_component_2": 1.6127223136049553, "log10_total_count": 4.196037940734523}, {"clade": "20B (B.1.1)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 14024, "AtoC": 0.01105248146035368, "AtoG": 0.0909155733029093, "AtoT": 0.028237307472903594, "CtoA": 0.019965772960638905, "CtoG": 0.005989731888191671, "CtoT": 0.42391614375356534, "GtoA": 0.04449515116942385, "GtoC": 0.006988020536223617, "GtoT": 0.1590844266970907, "TtoA": 0.03201654306902453, "TtoC": 0.15259555048488305, "TtoG": 0.024743297204791785, "principal_component_1": -3.108674846761565, "principal_component_2": -0.9550654619983266, "log10_total_count": 4.146871903085739}, {"clade": "20B (B.1.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 12908, "AtoC": 0.012008057018903007, "AtoG": 0.09552215680198327, "AtoT": 0.030678648899907034, "CtoA": 0.021691973969631236, "CtoG": 0.0027114967462039045, "CtoT": 0.38441276727610785, "GtoA": 0.04834211341803533, "GtoC": 0.007592190889370932, "GtoT": 0.17190889370932755, "TtoA": 0.03308026030368764, "TtoC": 0.165478772854044, "TtoG": 0.026572668112798264, "principal_component_1": -1.884892259804865, "principal_component_2": 1.1878208682597224, "log10_total_count": 4.1108589567318665}, {"clade": "20C (B.1.367)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 9210, "AtoC": 0.013137893593919652, "AtoG": 0.1007600434310532, "AtoT": 0.028447339847991315, "CtoA": 0.023127035830618894, "CtoG": 0.0028230184581976114, "CtoT": 0.41324647122692726, "GtoA": 0.050488599348534204, "GtoC": 0.007057546145494028, "GtoT": 0.1496199782844734, "TtoA": 0.03659066232356135, "TtoC": 0.1505971769815418, "TtoG": 0.024104234527687295, "principal_component_1": -1.5227247566989093, "principal_component_2": -0.3697102824953769, "log10_total_count": 3.9642596301968487}, {"clade": "20C (B.1.367)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 8489, "AtoC": 0.014135940629049357, "AtoG": 0.10884674284368005, "AtoT": 0.03086347037342443, "CtoA": 0.02509129461656261, "CtoG": 0.0030627871362940277, "CtoT": 0.37519142419601836, "GtoA": 0.054658970432324185, "GtoC": 0.007656967840735069, "GtoT": 0.16173872069737308, "TtoA": 0.03781364118270703, "TtoC": 0.15478854988809046, "TtoG": 0.02615149016374131, "principal_component_1": -0.5238584748880422, "principal_component_2": 1.6930322331394145, "log10_total_count": 3.9288565335819103}, {"clade": "20E (B.1.177)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 10444, "AtoC": 0.013117579471466871, "AtoG": 0.10570662581386442, "AtoT": 0.02862887782458828, "CtoA": 0.02049023362696285, "CtoG": 0.011394101876675604, "CtoT": 0.4389122941401762, "GtoA": 0.043278437380314054, "GtoC": 0.004595940252776714, "GtoT": 0.12562236690923018, "TtoA": 0.0347567981616239, "TtoC": 0.1509957870547683, "TtoG": 0.022500957487552663, "principal_component_1": -2.459381615748631, "principal_component_2": -2.3464966536665632, "log10_total_count": 4.018866863150906}, {"clade": "20E (B.1.177)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 9508, "AtoC": 0.01440891880521666, "AtoG": 0.1052797644089188, "AtoT": 0.031447202355910815, "CtoA": 0.02250736222128734, "CtoG": 0.002839713925115692, "CtoT": 0.40628944047118215, "GtoA": 0.04753891459823307, "GtoC": 0.005048380311316786, "GtoT": 0.13756836348338242, "TtoA": 0.0367059318468658, "TtoC": 0.16564997896508205, "TtoG": 0.024716028607488432, "principal_component_1": -1.1171462996933863, "principal_component_2": -0.13624784740822424, "log10_total_count": 3.9780891730561425}, {"clade": "20G (B.1.2)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 13850, "AtoC": 0.011985559566787004, "AtoG": 0.0916245487364621, "AtoT": 0.03277978339350181, "CtoA": 0.021083032490974728, "CtoG": 0.002527075812274368, "CtoT": 0.4449097472924188, "GtoA": 0.05061371841155235, "GtoC": 0.005054151624548736, "GtoT": 0.13581227436823104, "TtoA": 0.03494584837545126, "TtoC": 0.1447653429602888, "TtoG": 0.023898916967509027, "principal_component_1": -2.2038188826020746, "principal_component_2": -1.4833523934859116, "log10_total_count": 4.141449773400467}, {"clade": "20G (B.1.2)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 12861, "AtoC": 0.012907238939429282, "AtoG": 0.09835938107456652, "AtoT": 0.035300520954824666, "CtoA": 0.022704299821164762, "CtoG": 0.0026436513490397323, "CtoT": 0.4054117098203872, "GtoA": 0.0545058704610839, "GtoC": 0.005442811600964155, "GtoT": 0.1452453152943006, "TtoA": 0.03631132882357515, "TtoC": 0.15550890288469016, "TtoG": 0.025658968975973875, "principal_component_1": -1.0697246851708448, "principal_component_2": 0.4399016754880911, "log10_total_count": 4.109274738230295}, {"clade": "20I (Alpha)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 60789, "AtoC": 0.011630393656747109, "AtoG": 0.09778084850877626, "AtoT": 0.02864005000904769, "CtoA": 0.02212571353369853, "CtoG": 0.01572652947079241, "CtoT": 0.4329237197519288, "GtoA": 0.04532069946865387, "GtoC": 0.005198308904571551, "GtoT": 0.1359620984059616, "TtoA": 0.034595074766816364, "TtoC": 0.14556909967263815, "TtoG": 0.024527463850367665, "principal_component_1": -2.937553999549445, "principal_component_2": -2.109890543278508, "log10_total_count": 4.783824999149303}, {"clade": "20I (Alpha)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 55062, "AtoC": 0.012749264465511605, "AtoG": 0.10297482837528604, "AtoT": 0.03161890232828448, "CtoA": 0.024427009552867675, "CtoG": 0.0030147833351494677, "CtoT": 0.40683229813664595, "GtoA": 0.05003450655624569, "GtoC": 0.005720823798627002, "GtoT": 0.14950419527078565, "TtoA": 0.03428862010097708, "TtoC": 0.15431695179978933, "TtoG": 0.02451781627983001, "principal_component_1": -1.2135418249986043, "principal_component_2": 0.00120153983089801, "log10_total_count": 4.740851982087984}, {"clade": "21C (Epsilon)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 6306, "AtoC": 0.012844909609895337, "AtoG": 0.09007294640025372, "AtoT": 0.032667300983190616, "CtoA": 0.022835394862036156, "CtoG": 0.004123057405645417, "CtoT": 0.43847129717729144, "GtoA": 0.04804947668886775, "GtoC": 0.0045987947986045035, "GtoT": 0.13225499524262607, "TtoA": 0.035838883602917856, "TtoC": 0.1506501744370441, "TtoG": 0.02759276879162702, "principal_component_1": -2.419824228954735, "principal_component_2": -0.8505766134045225, "log10_total_count": 3.799753966411886}, {"clade": "21C (Epsilon)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 5843, "AtoC": 0.01386274174225569, "AtoG": 0.09669690227622796, "AtoT": 0.035255861714872494, "CtoA": 0.02464487420845456, "CtoG": 0.004278623994523361, "CtoT": 0.39654287181242515, "GtoA": 0.05185692281362314, "GtoC": 0.0049632038336470995, "GtoT": 0.14273489645729934, "TtoA": 0.03696731131268184, "TtoC": 0.16241656683210678, "TtoG": 0.029779223001882595, "principal_component_1": -1.2932417544846289, "principal_component_2": 1.2395395720902984, "log10_total_count": 3.7666358863102674}, {"clade": "21I (Delta)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 24055, "AtoC": 0.014466846809395136, "AtoG": 0.1163167740594471, "AtoT": 0.03246726252338391, "CtoA": 0.027187694865932237, "CtoG": 0.007441280399085429, "CtoT": 0.3789233007690709, "GtoA": 0.05308667636665974, "GtoC": 0.007191852005819996, "GtoT": 0.1518187487008938, "TtoA": 0.027270837663687382, "TtoC": 0.1586780295156932, "TtoG": 0.0251506963209312, "principal_component_1": -0.42582638698149194, "principal_component_2": 2.1647629410105123, "log10_total_count": 4.381205361238583}, {"clade": "21I (Delta)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 22316, "AtoC": 0.01492202903746191, "AtoG": 0.12067574834199678, "AtoT": 0.03499731134611938, "CtoA": 0.02930632729879907, "CtoG": 0.0033608173507797094, "CtoT": 0.34531278006811256, "GtoA": 0.05722351675927585, "GtoC": 0.00775228535579853, "GtoT": 0.16261874887972755, "TtoA": 0.027245025990320845, "TtoC": 0.17072952141960926, "TtoG": 0.025855888151998567, "principal_component_1": 0.9328268601021943, "principal_component_2": 3.9903652708218007, "log10_total_count": 4.348616352738332}, {"clade": "21J (Delta)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 281412, "AtoC": 0.015397353346694526, "AtoG": 0.11300513126661266, "AtoT": 0.032226770713402415, "CtoA": 0.028236180404531436, "CtoG": 0.010895057780052023, "CtoT": 0.37714454252128554, "GtoA": 0.05128423805665714, "GtoC": 0.007053714838031072, "GtoT": 0.14743507739542025, "TtoA": 0.027038647960996687, "TtoC": 0.16767941665600614, "TtoG": 0.02260386906031015, "principal_component_1": -0.282525008927236, "principal_component_2": 1.752281039449527, "log10_total_count": 5.449342612724405}, {"clade": "21J (Delta)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 261069, "AtoC": 0.015911502323140626, "AtoG": 0.1184322918462169, "AtoT": 0.03473794284269676, "CtoA": 0.03043639804036481, "CtoG": 0.003366925985084403, "CtoT": 0.34676656362877245, "GtoA": 0.05527657439221049, "GtoC": 0.007595693092630684, "GtoT": 0.15513140204313802, "TtoA": 0.027988769252573074, "TtoC": 0.18012479459453248, "TtoG": 0.024231141958639287, "principal_component_1": 1.2608041001988994, "principal_component_2": 3.7150369129079204, "log10_total_count": 5.416755305648182}, {"clade": "21K (Omicron BA.1)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 113009, "AtoC": 0.013768814873151696, "AtoG": 0.10856657434363634, "AtoT": 0.03366103584670248, "CtoA": 0.027369501544124805, "CtoG": 0.006680883823412294, "CtoT": 0.4121441655089418, "GtoA": 0.05631409887708059, "GtoC": 0.005672114610340769, "GtoT": 0.0704280190073357, "TtoA": 0.05411073454326647, "TtoC": 0.1882504933235406, "TtoG": 0.023033563698466493, "principal_component_1": 2.2979904095759074, "principal_component_2": -1.6806239095131572, "log10_total_count": 5.053113031932014}, {"clade": "21K (Omicron BA.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 103895, "AtoC": 0.014880408104336109, "AtoG": 0.11588623129120747, "AtoT": 0.036613889022570865, "CtoA": 0.02977044131093893, "CtoG": 0.003195533952548246, "CtoT": 0.38442658453246065, "GtoA": 0.06125415082535252, "GtoC": 0.00614081524616199, "GtoT": 0.07623080995235575, "TtoA": 0.042456326098464794, "TtoC": 0.20410029356561912, "TtoG": 0.02504451609798354, "principal_component_1": 3.346899796539079, "principal_component_2": 1.0657145446730236, "log10_total_count": 5.016594647416077}, {"clade": "21M (Omicron)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 81612, "AtoC": 0.013380385237465079, "AtoG": 0.10991030730774887, "AtoT": 0.029811792383473017, "CtoA": 0.02971376758319855, "CtoG": 0.010819487330294565, "CtoT": 0.42214380238200266, "GtoA": 0.054893888153702886, "GtoC": 0.006481889918149292, "GtoT": 0.07872616772043327, "TtoA": 0.04032495221290987, "TtoC": 0.18034112630495516, "TtoG": 0.023452433465666812, "principal_component_1": 1.2691860834244164, "principal_component_2": -1.37925272176431, "log10_total_count": 4.911754020893804}, {"clade": "21M (Omicron)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 74977, "AtoC": 0.014444429625085025, "AtoG": 0.1159155474345466, "AtoT": 0.03244995131840431, "CtoA": 0.03234325193059205, "CtoG": 0.0036144417621403898, "CtoT": 0.39485442202275367, "GtoA": 0.05975165717486696, "GtoC": 0.007055497019085853, "GtoT": 0.08521279859156808, "TtoA": 0.038571828694132865, "TtoC": 0.19029835816317003, "TtoG": 0.02548781626365419, "principal_component_1": 2.690418610670332, "principal_component_2": 0.8836569328103376, "log10_total_count": 4.874928059324915}, {"clade": "22A (Omicron BA.4)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 9001, "AtoC": 0.008887901344295079, "AtoG": 0.11009887790245529, "AtoT": 0.02921897566937007, "CtoA": 0.02833018553494056, "CtoG": 0.0024441728696811466, "CtoT": 0.42973002999666704, "GtoA": 0.06299300077769136, "GtoC": 0.005443839573380735, "GtoT": 0.08787912454171759, "TtoA": 0.04021775358293523, "TtoC": 0.17398066881457616, "TtoG": 0.020775469392289747, "principal_component_1": 2.1504781517793123, "principal_component_2": -2.955904881731707, "log10_total_count": 3.9542907617011265}, {"clade": "22A (Omicron BA.4)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 8362, "AtoC": 0.009567089213106911, "AtoG": 0.1182731403970342, "AtoT": 0.031451805788088975, "CtoA": 0.030495096866778284, "CtoG": 0.0026309495336044007, "CtoT": 0.3912939488160727, "GtoA": 0.06780674479789524, "GtoC": 0.005859842143027984, "GtoT": 0.09435541736426692, "TtoA": 0.03898588854341067, "TtoC": 0.1869170055010763, "TtoG": 0.022363071035637408, "principal_component_1": 3.4607228565348174, "principal_component_2": -1.0042719498171757, "log10_total_count": 3.9223101632143953}, {"clade": "22B (Omicron BA.5)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 46354, "AtoC": 0.010247227855201277, "AtoG": 0.10368037278336281, "AtoT": 0.02916684644259395, "CtoA": 0.02664279242352332, "CtoG": 0.003516417137679596, "CtoT": 0.4174181300427148, "GtoA": 0.06560383138456229, "GtoC": 0.006730810717521681, "GtoT": 0.09291539025758296, "TtoA": 0.04297363765802304, "TtoC": 0.1784959226819692, "TtoG": 0.022608620615265133, "principal_component_1": 1.905609315264128, "principal_component_2": -2.0325976947595428, "log10_total_count": 4.666087216430306}, {"clade": "22B (Omicron BA.5)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 42803, "AtoC": 0.011003901595682545, "AtoG": 0.11195476952550056, "AtoT": 0.03158657103474056, "CtoA": 0.028853117772118776, "CtoG": 0.0037847814405532324, "CtoT": 0.3831273508866201, "GtoA": 0.06340677055346589, "GtoC": 0.007289208700324744, "GtoT": 0.10032007102305913, "TtoA": 0.04139896736210079, "TtoC": 0.1928603135294255, "TtoG": 0.024414176576408195, "principal_component_1": 2.7120788375503517, "principal_component_2": -0.008917889562206507, "log10_total_count": 4.63147420914836}, {"clade": "22C (Omicron BA.2.12.1)", "subset": "all", "partition": "all", "excluded": "no", "total_count": 18629, "AtoC": 0.01009179236674003, "AtoG": 0.11686080841698428, "AtoT": 0.0274840302753771, "CtoA": 0.02630307584948199, "CtoG": 0.003113425304632562, "CtoT": 0.4231037629502389, "GtoA": 0.05512909979064899, "GtoC": 0.005636373396317569, "GtoT": 0.08529711739760588, "TtoA": 0.03784422137527511, "TtoC": 0.18680551827795372, "TtoG": 0.022330774598743892, "principal_component_1": 1.661169259565792, "principal_component_2": -2.408935806940851, "log10_total_count": 4.2701895427041805}, {"clade": "22C (Omicron BA.2.12.1)", "subset": "all", "partition": "all", "excluded": "yes", "total_count": 17324, "AtoC": 0.010794273839759871, "AtoG": 0.12502886169475871, "AtoT": 0.029554375432925422, "CtoA": 0.028284460863541906, "CtoG": 0.003347956592011083, "CtoT": 0.3904987300854306, "GtoA": 0.05928192103440314, "GtoC": 0.006060955899330409, "GtoT": 0.08722004156084046, "TtoA": 0.035788501500808124, "TtoC": 0.20012699145693835, "TtoG": 0.024012930039251906, "principal_component_1": 2.8744521822759226, "principal_component_2": -0.5791162718346048, "log10_total_count": 4.238648175057804}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>